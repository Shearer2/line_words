import psycopg2
import os
import hashlib
from dotenv import load_dotenv
from aiogram import Bot, Dispatcher, executor, types
from aiogram.types import InlineQueryResultArticle, InputTextMessageContent  # –î–ª—è —Ä–∞–±–æ—Ç—ã –∏–Ω–ª–∞–π–Ω —Ä–µ–∂–∏–º–∞.
from aiogram.utils.callback_data import CallbackData
from postgresql import db_start, information_id, information_vote, create_profile, delete_profile, right_words
from keyboards import get_kb, get_url_kb, get_ikb, get_github


# Bot - –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –Ω–∞ –∫–∞–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∫–∞–∫–∏–º —Å–ø–æ—Å–æ–±–æ–º –æ—Ç–≤–µ—á–∞—Ç—å.
# Dispatcher - –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.
# Executor - –∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞ –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–ª–µ–¥—É–µ—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç—å.
# Types - –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –±–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã –¥–ª—è –∞–Ω–Ω–æ—Ç–∏—Ä–æ–≤–∞–Ω–∏—è, —Ç–æ –µ—Å—Ç—å –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π.
# –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —Å–∫—Ä—ã—Ç—å –æ—Ç –ø–æ—Å—Ç—Ä–æ–Ω–Ω–∏—Ö –≥–ª–∞–∑.
load_dotenv()
# –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã bot –∏ Dispatcher, –ø–µ—Ä–µ–¥–∞–≤ –ø–µ—Ä–≤–æ–º—É —Ç–æ–∫–µ–Ω. –ï—Å–ª–∏ —ç—Ç–æ–≥–æ –Ω–µ —Å–¥–µ–ª–∞—Ç—å, —Ç–æ –∫–æ–¥ –Ω–µ –±—É–¥–µ—Ç
# —Ä–∞–±–æ—Ç–∞—Ç—å. –ó–∞–±–∏—Ä–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞—à–µ–≥–æ —Ç–æ–∫–µ–Ω–∞.
bot = Bot(token=os.getenv('API_TOKEN'))
# storage - —ç—Ç–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, –≤ –∫–æ—Ç–æ—Ä–æ–º –±—É–¥—É—Ç —Ö—Ä–∞–Ω–∏—Ç—å—Å—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –±–æ—Ç—É.
dp = Dispatcher(bot=bot)
HELP_COMMAND = """
<b>/start</b> - <em>–Ω–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º.</em>
<b>/vote</b> - <em>–≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ.</em>
<b>/link</b> - <em>–ø–µ—Ä–µ–π—Ç–∏ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π github.</em>
<b>/projects</b> - <em>–æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –ø—Ä–æ–µ–∫—Ç–∞–º–∏.</em>
<b>/description</b> - <em>–æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞.</em>
<b>/help</b> - <em>–≤—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥.</em>
"""
like, dislike = '', ''
cb = CallbackData('ikb', 'action')


# –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏, —á—Ç–æ –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç.
async def on_startup(_) -> None:
    await db_start()


# –ß—Ç–æ–±—ã –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –∫–æ—Ç–æ—Ä–æ–µ –±—É–¥–µ—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è –ø—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–æ–º–∞–Ω–¥—ã /start,
# –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–æ–∑–¥–∞—Ç—å message_handler –∏ –ø—Ä–æ–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –æ—Ç–≤–µ—Ç–∞.
@dp.message_handler(commands=['start'])  # –Ø–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞–µ–º –≤ –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–µ, –Ω–∞ –∫–∞–∫—É—é –∫–æ–º–∞–Ω–¥—É —Ä–µ–∞–≥–∏—Ä—É–µ–º.
async def send_welcome(message: types.Message) -> None:
    # –î–ª—è –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞ –ø–∏—à–µ–º await. –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø—Ä–∏ –ø–æ–º–æ—â–∏ reply.
    # parse_mode –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–∫–∞–∑—ã–≤–∞—Ç—å –∫–∞–∫–æ–π-—Ç–æ —è–∑—ã–∫, —á—Ç–æ–±—ã –≤ —Ç–µ–∫—Å—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–∞–Ω–Ω–æ–≥–æ —è–∑—ã–∫–∞.
    await message.reply("<em>–ü—Ä–∏–≤–µ—Ç! ü§ö\n –Ø - –±–æ—Ç ü§ñ, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã–π –¥–ª—è –∏–≥—Ä—ã –ª–∏–Ω–∏—è —Å–ª–æ–≤–∞.</em>", parse_mode="HTML")
    # –î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è —Ç—É–¥–∞, –≥–¥–µ –ø–∏—à–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å, –Ω—É–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å message.chat.id. –î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è
    # —Ç–æ–ª—å–∫–æ –≤ –ª–∏—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω –ø–∏—à–µ—Ç –≤ –≥—Ä—É–ø–ø–µ, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è message.from_user.id.
    await bot.send_photo(chat_id=message.chat.id,
                         photo="https://play-lh.googleusercontent.com"
                               "/F3mmWSAnQ8Y3ys8KY8v0tD0Sd1hLHoSbA3SGsmQWbt5KsZq9rh2grAefGbgQKkv2Tlg")


# –í –∫–∞—á–µ—Å—Ç–≤–µ –∫–æ–º–∞–Ω–¥—ã –≤—ã–∑–æ–≤–∞ —É–∫–∞–∑—ã–≤–∞–µ–º —Å—Å—ã–ª–∫–∏, –∞ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ reply_markup –ø–µ—Ä–µ–¥–∞—ë–º –Ω–∞–∑–≤–∞–Ω–∏–µ –Ω–∞—à–µ–π –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã.
@dp.message_handler(commands=['link'])
async def bot_link(message: types.Message) -> None:
    # –ü–∏—à–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–∏ –ø–æ–º–æ—â–∏ answer.
    await message.answer('–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π github:', reply_markup=get_github())


# –î–µ–ª–∞–µ–º –æ–±—Ä–∞–±–æ—Ç–∫—É –∫–æ–º–∞–Ω–¥—ã help.
@dp.message_handler(commands=['help'])
async def bot_help(message: types.Message) -> None:
    await message.answer(HELP_COMMAND, parse_mode="HTML")


# –í—ã–≤–æ–¥–∏–º —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤.
@dp.message_handler(commands=['projects'])
async def bot_projects(message: types.Message) -> None:
    await message.answer('–ú–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã:', reply_markup=get_url_kb())


# –í—ã–≤–æ–¥–∏–º –æ–ø–∏—Å–∞–Ω–∏–µ –±–æ—Ç–∞.
@dp.message_handler(commands=['description'])
async def bot_description(message: types.Message) -> None:
    await message.answer("–î–∞–Ω–Ω—ã–π –±–æ—Ç –≤—ã–¥–∞—ë—Ç –≤—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ —Å–ª–æ–≤–∞ –Ω–∞ –≤–≤–µ–¥—ë–Ω–Ω—ã–µ –±—É–∫–≤—ã. –ï—Å—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞—Ç—å –∑–∞ "
                         "—Ç–æ, –≤—Å–µ –ª–∏ —Å–ª–æ–≤–∞ –±—ã–ª–∏ –Ω–∞–π–¥–µ–Ω—ã –∏–ª–∏ –Ω–µ—Ç. –ú–æ–∂–Ω–æ –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å –ø—Ä–æ–µ–∫—Ç–∞–º–∏ –∞–≤—Ç–æ—Ä–∞ –∏–ª–∏ –∂–µ —Å "
                         "—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–æ–º –±–æ—Ç–∞ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—É help.")


# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è.
@dp.message_handler(commands=['vote'])
async def bot_vote(message: types.Message) -> None:
    await message.answer("–í—Å–µ –ª–∏ —Å–ª–æ–≤–∞ —É–≥–∞–¥—ã–≤–∞—é—Ç—Å—è?\n\n"
                         f"–°–ª–æ–≤ —Ö–≤–∞—Ç–∞–µ—Ç:\n{information_vote().count('like') * 'üëç'}\n\n"
                         f"–°–ª–æ–≤ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç:\n{information_vote().count('dislike') * 'üëé'}", reply_markup=get_ikb())


# –°–æ–∑–¥–∞—ë–º callback —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏—è.
@dp.callback_query_handler()
async def vote_callback(callback: types.CallbackQuery) -> None:
    global like, dislike
    user_id = callback['from']['id']
    # callback - —Å–ª–æ–≤–∞—Ä—å, –≤ –∫–æ—Ç–æ—Ä–æ–º —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤—Å—è –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ, –æ —Å–æ–æ–±—â–µ–Ω–∏–∏, –æ –≤—ã–±–æ—Ä–µ –æ—Ç–≤–µ—Ç–∞.
    if callback.data == 'like' and user_id not in information_id():
        like += 'üëç'
        await create_profile(user_id, callback.data)
        if len(like) >= len(dislike):
            # –ù–µ –Ω—É–∂–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å return, —Ç–∞–∫ –∫–∞–∫ callback.answer –∑–∞–≤–µ—Ä—à–∞–µ—Ç –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ callback —Ñ—É–Ω–∫—Ü–∏–∏.
            await callback.message.edit_text("–í—Å–µ –ª–∏ —Å–ª–æ–≤–∞ —É–≥–∞–¥—ã–≤–∞—é—Ç—Å—è?\n\n"
                                             "–°–ª–æ–≤ —Ö–≤–∞—Ç–∞–µ—Ç:\n"
                                             f"{like}\n"
                                             "–°–ª–æ–≤ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç:\n"
                                             f"{dislike}",
                                             reply_markup=get_ikb())
        else:
            await callback.message.edit_text("–í—Å–µ –ª–∏ —Å–ª–æ–≤–∞ —É–≥–∞–¥—ã–≤–∞—é—Ç—Å—è?\n\n"
                                             "–°–ª–æ–≤ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç:\n"
                                             f"{dislike}\n"
                                             "–°–ª–æ–≤ —Ö–≤–∞—Ç–∞–µ—Ç:\n"
                                             f"{like}",
                                             reply_markup=get_ikb())
    elif callback.data == 'dislike' and user_id not in information_id():
        dislike += 'üëé'
        await create_profile(user_id, callback.data)
        if len(like) >= len(dislike):
            await callback.message.edit_text("–í—Å–µ –ª–∏ —Å–ª–æ–≤–∞ —É–≥–∞–¥—ã–≤–∞—é—Ç—Å—è?\n\n"
                                             "–°–ª–æ–≤ —Ö–≤–∞—Ç–∞–µ—Ç:\n"
                                             f"{like}\n"
                                             "–°–ª–æ–≤ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç:\n"
                                             f"{dislike}",
                                             reply_markup=get_ikb())
        else:
            await callback.message.edit_text("–í—Å–µ –ª–∏ —Å–ª–æ–≤–∞ —É–≥–∞–¥—ã–≤–∞—é—Ç—Å—è?\n\n"
                                             "–°–ª–æ–≤ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç:\n"
                                             f"{dislike}\n"
                                             "–°–ª–æ–≤ —Ö–≤–∞—Ç–∞–µ—Ç:\n"
                                             f"{like}",
                                             reply_markup=get_ikb())
    elif callback.data == 'delete' and user_id in information_id():
        await delete_profile(user_id)
    else:
        await callback.message.answer("–í—ã —É–∂–µ –ø—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞–ª–∏!")


@dp.inline_handler()
async def inline_words(inline_query: types.InlineQuery) -> None:
    # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
    text = inline_query.query
    # –§–æ—Ä–º–∏—Ä—É–µ–º –∫–æ–Ω—Ç–µ–Ω—Ç –æ—Ç–≤–µ—Ç–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è.
    input_content = InputTextMessageContent(right_words(text.lower()))
    # –î–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è —É –Ω–µ–≥–æ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä, –¥–ª—è –µ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –±—É–¥–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
    # —Ö—ç—à-—Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è —Å–æ–æ–±—â–µ–Ω–∏—è.
    # –ü–æ–ª—É—á–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–æ–¥–∏–º –≤ –¥–≤–æ–∏—á–Ω—É—é —Å–∏—Å—Ç–µ–º—É —Å—á–∏—Å–ª–µ–Ω–∏—è, –∑–∞—Ç–µ–º –∫–æ–¥–∏—Ä—É–µ–º –∏ –ø–µ—Ä–µ–≤–æ–¥–∏–º –≤ 16-—É—é —Å–∏—Å—Ç–µ–º—É —Å—á–∏—Å–ª–µ–Ω–∏—è.
    result_id = hashlib.md5(text.encode()).hexdigest()

    # –ß—Ç–æ–±—ã –æ—Ç–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Article. –û–Ω —è–≤–ª—è–µ—Ç—Å—è –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º –∫–ª–∞—Å—Å–æ–º.
    # thumb_url –Ω—É–∂–µ–Ω –¥–ª—è –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ –∫–∞—Ä—Ç–∏–Ω–∫–∏.
    item = InlineQueryResultArticle(
        input_message_content=input_content,
        id=result_id,
        title='–õ–∏–Ω–∏—è —Å–ª–æ–≤–∞',
        description='–í–≤–µ–¥–∏—Ç–µ –±—É–∫–≤—ã',
        thumb_url='https://play-lh.googleusercontent.com'
                  '/F3mmWSAnQ8Y3ys8KY8v0tD0Sd1hLHoSbA3SGsmQWbt5KsZq9rh2grAefGbgQKkv2Tlg'
    )

    # –û—Ç–≤–µ—á–∞–µ–º –Ω–∞ –∏–Ω–ª–∞–π–Ω –∑–∞–ø—Ä–æ—Å. –£–∫–∞–∑—ã–≤–∞–µ–º id —Å–æ–æ–±—â–µ–Ω–∏—è, –∑–∞—Ç–µ–º –ø–µ—Ä–µ–¥–∞—ë–º —Å–ø–∏—Å–æ–∫ –∏–∑ —Ç–µ—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–º–∏ –º—ã –±—É–¥–µ–º
    # –æ—Ç–≤–µ—á–∞—Ç—å, –∑–∞—Ç–µ–º —É–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ –≤—Ä–µ–º—è –≤ —Ç–µ—á–µ–Ω–∏–∏ –∫–æ—Ç–æ—Ä–æ–≥–æ –≤ —Ç–µ–ª–µ–≥—Ä–∞–º api –±—É–¥—É—Ç –∫–µ—à–∏—Ä–æ–≤–∞—Ç—å—Å—è –¥–∞–Ω–Ω—ã–µ.
    await bot.answer_inline_query(inline_query_id=inline_query.id,
                                  results=[item],
                                  cache_time=1)


# –°–æ–∑–¥–∞—ë–º –Ω–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ, –∫–æ—Ç–æ—Ä–æ–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ –æ—Ç–≤–µ—Ç –Ω–∞ –ª—é–±–æ–π —Ç–µ–∫—Å—Ç, –≤–≤–µ–¥—ë–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º.
@dp.message_handler()
async def words(message: types.Message) -> None:
    # –í —Å—Ç—Ä–æ–∫—É –¥–ª—è –æ—Ç–≤–µ—Ç–∞ –¥–æ–±–∞–≤–ª—è–µ–º reply_markup=keyboard, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –≤ —Ç–µ–ª–µ–≥—Ä–∞–º.
    await message.answer(text=right_words(message.text.lower()), reply_markup=get_kb())


# –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º –ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –≤ —Ç–µ–ª–µ–≥—Ä–∞–º. –ï—Å–ª–∏ —ç—Ç–æ–≥–æ –Ω–µ —Å–¥–µ–ª–∞—Ç—å, —Ç–æ –º—ã –Ω–µ –ø–æ–ª—É—á–∏–º –æ—Ç–≤–µ—Ç—ã –±–æ—Ç–∞.
# start_polling –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Å–µ—Ä–≤–µ—Ä, –ø—Ä–æ–≤–µ—Ä—è—è –Ω–∞ –Ω—ë–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å, —Ç–æ –æ–Ω–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç –≤ —Ç–µ–ª–µ–≥—Ä–∞–º.
if __name__ == '__main__':
    # skip_updates –Ω—É–∂–Ω–æ —á—Ç–æ–±—ã –≤—Å–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–∞–ª–∏—Å—å. –ï—Å–ª–∏ –±—É–¥–µ—Ç False, —Ç–æ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—É—Å–∫–µ –±–æ—Ç –±—É–¥–µ—Ç –ø—ã—Ç–∞—Ç—å—Å—è
    # –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã, –ø–æ–∫–∞ –æ–Ω –±—ã–ª –≤—ã–∫–ª—é—á–µ–Ω.
    executor.start_polling(dp, skip_updates=True, on_startup=on_startup)
